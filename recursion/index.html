
<!doctype html>
<html lang="pt" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.3">
    
    
      
        <title>Recursão - Programação Funcional</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e35208c4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-PJX835H7DP","lasarojc.github.org/dsnotes"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#recursividade" class="md-skip">
          Ir para o conteúdo
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Programação Funcional" class="md-header__button md-logo" aria-label="Programação Funcional" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Programação Funcional
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Recursão
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Buscar" placeholder="Buscar" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/lasarojc/pf_notes" title="Ir ao repositório" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Programação Funcional" class="md-nav__button md-logo" aria-label="Programação Funcional" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Programação Funcional
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/lasarojc/pf_notes" title="Ir ao repositório" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../preface/" class="md-nav__link">
        Prefácio
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../intro/" class="md-nav__link">
        Introdução
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../haskell101/" class="md-nav__link">
        Haskell 1+1
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../functions/" class="md-nav__link">
        Funções
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ifthenelse/" class="md-nav__link">
        If Then Else
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../guards/" class="md-nav__link">
        Guardas
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        Tipos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tuples/" class="md-nav__link">
        Tuplas
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../pattern_matching/" class="md-nav__link">
        Padrões
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Recursão
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Recursão
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Índice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Índice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#em-haskell" class="md-nav__link">
    Em Haskell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursao-e-listas" class="md-nav__link">
    Recursão e Listas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursao-de-cauda" class="md-nav__link">
    Recursão de Cauda
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../where_let_in/" class="md-nav__link">
        Where e Let-In
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../lists/" class="md-nav__link">
        Listas
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quickcheck/" class="md-nav__link">
        QuickCheck
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../type_classes.md" class="md-nav__link">
        Classes de tipos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        Entrada e Saída
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../observations/" class="md-nav__link">
        Observações
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../project/" class="md-nav__link">
        Projeto
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Índice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Índice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#em-haskell" class="md-nav__link">
    Em Haskell
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursao-e-listas" class="md-nav__link">
    Recursão e Listas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursao-de-cauda" class="md-nav__link">
    Recursão de Cauda
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              

<!-- Edit button -->


  <!--
       Hack: check whether the content contains a h1 headline. If it
       doesn't, the page title (or respectively site name) is used
       as the main headline.
    -->


  <!-- Content -->
  <h1 id="recursividade">Recursividade</h1>
<p>Uma função é dita recursiva quando ela é <strong>definida em termos de si mesma</strong>.</p>
<p><img alt="" src="../drawings/function.drawio-4.svg" /></p>
<p>Estas funções são muito importantes tanto na matemática, onde são também conhecidas como <strong>recorrências</strong>.
Por exemplo, vejamos como é definido um exemplo recorrentes de função na computação (<em>pun intended</em>) de forma recursiva, o cálculo do fatorial de um número.
Considere a seguinte definição.</p>
<div class="arithmatex">\[
n! =
     \begin{cases}
     1          &amp; \text{se } n = 0\\
     n * (n-1)! &amp; \text{se } n &gt; 0
     \end{cases}
\]</div>
<p>Por esta definição, podemos calcular o fatorial de 4, por exemplo, assim.</p>
<div class="arithmatex">\[ 
\begin{align}
4! &amp;= 4 * (4-1)!                        \\
      &amp;= 4 * (3 * (3-1)!)               \\
      &amp;= 4 * (3 * (2 * (2-1)!))         \\
      &amp;= 4 * (3 * (2 * (1 * (1-1)!)))   \\
      &amp;= 4 * (3 * (2 * (1 * 0!)))       \\
      &amp;= 4 * (3 * (2 * (1 * 1)))        \\
      &amp;= 4 * (3 * (2 * 1))              \\
      &amp;= 4 * (3 * 2)                    \\
      &amp;= 4 * 6                          \\
      &amp;= 24
\end{align}
\]</div>
<p>Na computação, as funções recursivas são importantes por serem uma <strong>estratégia de resolução de problemas</strong>, pois possibilitam resolver problemas pouco a pouco, e especialmente importantes na programação funcional, onde servem de alternativa às instruções de iteração como <code class="highlight"><span class="k">for</span><span class="p">(;;)</span></code> e <code class="highlight"><span class="k">while</span><span class="p">()</span></code>, comuns nas linguagens imperativas.</p>
<h2 id="em-haskell">Em Haskell</h2>
<p>Não há nada de especial em termos de sintaxe na declaração de funções recursivas.
O cálculo do fatorial pode ser traduzido quase que diretamente para Haskell usando guardas.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">fatorialGuardas</span> <span class="n">n</span>
     <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">=</span> <span class="mi">1</span>
     <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fatorialGuardas</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>Observe que a definição é iniciada tratando o caso em que <code>0</code> é passado como parâmetro; este é o que chamamos de <strong>caso base</strong>, que serve para limitar a recursão e impedir que execute para sempre.</p>
<p>Já o que torna a função recursiva acontece na última linha: a invocação da própria função.
Como esta invocação será feita para o valor passado como parâmetro menos 1, temos a garantia de que, para qualquer número positivo passado como parâmetro, em algum momento haverá uma invocação da função com o parâmetro igual a <code>0</code>, que será respondida pelo caso base.</p>
<p>É importante ficar claro que para cada invocação da função, <span class="arithmatex">\(n\)</span> assume um valor diferente, o que pode fazer parecer que o valor de <span class="arithmatex">\(n\)</span> está mudando, mas isso não poderia estar mais longe da verdade!
Cada <span class="arithmatex">\(n\)</span> só existe no escopo de uma invocação da função.
Pictograficamente, <span class="arithmatex">\(n\)</span> só é visível dentro da "caixinha" onde foi associada a um valor.</p>
<p><img alt="" src="../drawings/function.drawio-5.svg" /></p>
<p>Outra forma absolutamente equivalente de definir a função é usando casamento de padrões, como a seguir.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">fatorialPM</span> <span class="mi">0</span> <span class="ow">=</span> <span class="mi">1</span>
<span class="nf">fatorialPM</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fatorialPM</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>Considerando as duas definições da função, considere o que acontece se as mesmas forem invocadas com um número negativo como parâmetro. 
O que acontece? A recursão simplesmente "nunca" termina, continuando com <span class="arithmatex">\(n\)</span> indo para o - infinito.
Acontece que não é definido o fatorial de números negativos e, por isso, precisamos que um erro seja lançado quando uma tentativa de invocação deste tipo ocorrer.
Há diferentes formas de se lançar um erro, sendo a primeira simplesmente limitar os valores válidos para os parâmetros.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">fatorialGuardas</span> <span class="n">n</span>
     <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">=</span> <span class="mi">1</span>
     <span class="o">|</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fatorialGuardas</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>A outra alternativa é explicitamente causar um erro.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">fatorialGuardas&#39;</span> <span class="n">n</span>
     <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">=</span> <span class="mi">1</span>
     <span class="o">|</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fatorialGuardas&#39;</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
     <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="ne">error</span> <span class="s">&quot;Não se pode calcular o fatorial de números negativos&quot;</span>

<span class="nf">fatorialGuardas&#39;&#39;</span> <span class="n">n</span>
     <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">=</span> <span class="mi">1</span>
     <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="kr">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="kr">then</span> <span class="n">n</span> <span class="o">*</span> <span class="n">fatorialGuardas&#39;&#39;</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 
                            <span class="kr">else</span> <span class="ne">error</span> <span class="s">&quot;Não se pode calcular o fatorial de números negativos&quot;</span>
</code></pre></div>
</td></tr></table>
<div class="admonition note inline end">
<p class="admonition-title">Funções Recursivas</p>
<ul>
<li>Caso base - Limita recursão.</li>
<li>Caso geral - Faz chamada recursiva para problema "<strong>menor</strong>"</li>
</ul>
</div>
<p>Note que em ambas as formas, temos algumas definições simples, os <strong>casos base</strong>, que não fazem recursão, e os <strong>casos recursivos</strong>, envolvem recursão.
Este padrão se repetirá praticamente sempre nas definições recursivas, o que não quer dizer que a definição será óbvia. </p>
<h6>Máximo Divisor Comum</h6>
<p>O máximo divisor comum de dois números é, bem, o maior dentre os divisores comuns.
Por exemplo, considere os números 18 e 12: já que o 18 tem como divisores {18, 9, 6, 3, 2, 1} e o 12 tem {12, 6, 4, 3, 2, 1}, 
o maior dentre os divisores comuns é 6, isto é, o mdc(18,12) = 6.</p>
<p>Logo, se quisermos implementar uma função que calcule o mdc, podemos começar por encontrar o conjunto de divisores, usando uma recursão, e então iterar pelos conjuntos para identificar o maior comum, com outra recursão.
Enquanto esta abordagem é um bom exercício de manipulação de listas, se o objetivo é calcular o mdc de forma recursiva, há uma abordagem melhor, conhecida como o <a href="https://pt.khanacademy.org/computing/computer-science/cryptography/modarithmetic/a/the-euclidean-algorithm">algoritmo de Euclides</a>.
De forma direta, este algoritmo pode ser expresso como a seguinte função recursiva, onde <span class="arithmatex">\(a &gt;= b\)</span></p>
<div class="arithmatex">\[
mdc(a,b) =
     \begin{cases}
     a                    &amp; \text{se } b = 0\\
     \text{mdc}(b, a \text{ mod } b)    &amp; \text{caso contrário }
     \end{cases}
\]</div>
<p>Em Haskell, a definição fica assim.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">mdc</span> <span class="ow">::</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span> <span class="ow">-&gt;</span> <span class="kt">Integer</span>
<span class="nf">mdc</span> <span class="n">a</span> <span class="n">b</span>
      <span class="o">|</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span>     <span class="ow">=</span> <span class="n">a</span>
      <span class="o">|</span> <span class="n">otherwise</span>  <span class="ow">=</span> <span class="n">mdc</span> <span class="n">b</span> <span class="p">(</span><span class="n">a</span> <span class="p">`</span><span class="n">mod</span><span class="p">`</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<h6>Fibonacci</h6>
<p>Considere a função que retorna um termo da sequência de Fibonacci, em que os dois primeiros termos são 1 e todos os outros termos são iguais à soma dos dois termos anteriores.</p>
<div class="arithmatex">\[
F(n) =
     \begin{cases}
     1                    &amp; \text{se } n = 1\\
     1                    &amp; \text{se } n = 2\\
     F(n-1) + F(n - 2)    &amp; \text{se } n &gt; 2
     \end{cases}
\]</div>
<p>A mesma tradução direta da definição matemática para Haskell também pode ser feita aqui, sendo a única diferença o fato de que duas invocações recursivas são feitas a cada passo.
Há, contudo, diversas possibilidades de tradução.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">fibIf</span> <span class="n">n</span> <span class="ow">=</span> <span class="kr">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="kr">then</span> <span class="mi">1</span>
          <span class="kr">else</span> <span class="kr">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span> <span class="kr">then</span> <span class="mi">1</span>
          <span class="kr">else</span> <span class="n">fibIf</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fibIf</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="nf">fibGuard</span> <span class="n">n</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">=</span> <span class="mi">1</span>
  <span class="o">|</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">=</span> <span class="mi">1</span>
  <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">fibGuard</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fibGuard</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="nf">fibPattern</span> <span class="mi">1</span> <span class="ow">=</span> <span class="mi">1</span>
<span class="nf">fibPattern</span> <span class="mi">2</span> <span class="ow">=</span> <span class="mi">1</span>
<span class="nf">fibPattern</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">fibPattern</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fibPattern</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="nf">fibCase</span> <span class="n">x</span> <span class="ow">=</span> <span class="kr">case</span> <span class="n">x</span> <span class="kr">of</span> <span class="mi">1</span> <span class="ow">-&gt;</span> <span class="mi">0</span>
                      <span class="mi">2</span> <span class="ow">-&gt;</span> <span class="mi">1</span>
                      <span class="n">n</span> <span class="ow">-&gt;</span> <span class="n">fibCase</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fibCase</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<h6>Conjectura de Collatz</h6>
<p>Considere a seguinte função para construir uma sequência de números usando <span class="arithmatex">\(n\)</span> como base.</p>
<div class="arithmatex">\[
F_n(i) =
     \begin{cases}
     n                    &amp; \text{se } i = 1\\
     F_n(i-1)/2           &amp; \text{se } F_n(i-1) \text{ é par}\\
     F_n(i-1)* 3 + 1     &amp; \text{se } F_n(i-1) \text{ é ímpar}
     \end{cases}
\]</div>
<div class="admonition exercise">
<p class="admonition-title">Exercício</p>
<p>Defina a função acima em Haskell.</p>
</div>
<p>Segundo a <a href="https://en.wikipedia.org/wiki/Collatz_conjecture">conjectura de Collatz</a>, para qualquer valor de <span class="arithmatex">\(n\)</span>, em algum momento a sequência converge para o valor 1 e a partir daí repete infinitamente os termos 4, 2, 1.
Por exemplo, </p>
<ul>
<li>para <span class="arithmatex">\(n=7\)</span>, a sequência é 7, 22, 11, 34, 17, 52, 26, 13, 40, 20, 10, 5, 16, 8, 4, 2, 1;</li>
<li>para <span class="arithmatex">\(n=12\)</span>,  12, 6, 3, 10, 5, 16, 8, 4, 2, 1; </li>
<li>para <span class="arithmatex">\(n=19\)</span>, 19, 58, 29, 88, 44, 22, 11, 34, 17, 52, 26, 13, 40, 20, 10, 5, 16, 8, 4, 2, 1; e,</li>
<li>para <span class="arithmatex">\(n=27\)</span>, 27, 82, 41, 124, 62, 31, 94, 47, 142, 71, 214, 107, 322, 161, 484, 242, 121, 364, 182, 91, 274, 137, 412, 206, 103, 310, 155, 466, 233, 700, 350, 175, 526, 263, 790, 395, 1186, 593, 1780, 890, 445, 1336, 668, 334, 167, 502, 251, 754, 377, 1132, 566, 283, 850, 425, 1276, 638, 319, 958, 479, 1438, 719, 2158, 1079, 3238, 1619, 4858, 2429, 7288, 3644, 1822, 911, 2734, 1367, 4102, 2051, 6154, 3077, 9232, 4616, 2308, 1154, 577, 1732, 866, 433, 1300, 650, 325, 976, 488, 244, 122, 61, 184, 92, 46, 23, 70, 35, 106, 53, 160, 80, 40, 20, 10, 5, 16, 8, 4, 2, 1</li>
</ul>
<p>Esta é uma conjectura pois não se sabe se a sequência realmente converge para 1 dado qualquer <span class="arithmatex">\(n\)</span>. 
O que você acha de testar alguns valores para tentar identificar há ou não uma convergência? 
Em C, poderíamos fazer o seguinte:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="nf">collatz</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i</span><span class="p">){</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
          <span class="k">return</span> <span class="n">n</span><span class="p">;</span>
     <span class="k">else</span> <span class="p">{</span>
          <span class="kt">int</span> <span class="n">f_n_i_menos_1</span> <span class="o">=</span> <span class="n">collatz</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="mi">-1</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">f_n_i_menos_1</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
               <span class="k">return</span> <span class="n">f_n_i_menos_1</span> <span class="o">/</span><span class="mi">2</span><span class="p">;</span>
          <span class="k">else</span>
               <span class="n">f_n_i_menos_1</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">converge</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
     <span class="kt">bool</span> <span class="n">convergiu</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
     <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">!</span><span class="n">convergiu</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
          <span class="n">convergiu</span> <span class="o">=</span> <span class="n">collatz</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">;</span>
     <span class="k">return</span> <span class="n">convergiu</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>Por mais ineficiente que seja, este código em C funciona e pode servir de base para uma versão em Haskell, mas como escrever a iteração?
Como dito anteriormente, a iteração pode ser feita por meio de outra recursão!</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">collatz</span> <span class="ow">::</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Int</span>
<span class="nf">collatz</span> <span class="n">n</span> <span class="n">i</span>
    <span class="o">|</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">=</span> <span class="n">n</span>
    <span class="o">|</span> <span class="n">even</span> <span class="p">(</span><span class="n">collatz</span> <span class="n">n</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="ow">=</span> <span class="n">collatz</span> <span class="n">n</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">2</span>
    <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">collatz</span> <span class="n">n</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>


<span class="nf">converge</span> <span class="ow">::</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Bool</span>
<span class="nf">converge</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">convergeInterna</span> <span class="n">n</span> <span class="mi">1</span>


<span class="nf">convergeInterna</span> <span class="ow">::</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Bool</span>
<span class="nf">convergeInterna</span> <span class="n">n</span> <span class="n">passo</span>
    <span class="o">|</span> <span class="n">collatz</span> <span class="n">n</span> <span class="n">passo</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">=</span> <span class="kt">True</span>
    <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">convergeInterna</span> <span class="n">n</span> <span class="p">(</span><span class="n">passo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>Vejamos alguns exemplos.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">*</span><span class="kt">Main</span><span class="o">&gt;</span> <span class="n">collatz</span> <span class="mi">7</span> <span class="mi">13</span>
<span class="mi">16</span>
<span class="o">*</span><span class="kt">Main</span><span class="o">&gt;</span> <span class="n">collatz</span> <span class="mi">7</span> <span class="mi">17</span>
<span class="mi">1</span>
<span class="o">*</span><span class="kt">Main</span><span class="o">&gt;</span> <span class="n">converge</span> <span class="mi">7</span>
<span class="kt">True</span>
<span class="o">*</span><span class="kt">Main</span><span class="o">&gt;</span> <span class="n">converge</span> <span class="mi">12</span>
<span class="kt">True</span>
<span class="o">*</span><span class="kt">Main</span><span class="o">&gt;</span> <span class="n">convergeInterna</span> <span class="mi">7</span> <span class="mi">15</span>
<span class="kt">True</span>
<span class="o">*</span><span class="kt">Main</span><span class="o">&gt;</span> <span class="n">convergeInterna</span> <span class="mi">7</span> <span class="mi">1</span>
<span class="kt">True</span>
</code></pre></div>
</td></tr></table>
<p>Tente executar a função para o número 27, cuja sequência calculada acima tem 111 passos.
Quando seu computador começar a se desesperar ou você cansar de esperar, aperte <span class="keys"><kbd class="key-control">Ctrl</kbd></span> + <span class="keys"><kbd class="key-c">C</kbd></span>.
Mas por quê esta função tão simples ficou tão pesada? Por quê para calcular se a sequência converge, primeiro a função testou o primeiro termo, 27, e viu que não era igual 1; calculou então o segundo termo, para isto calculando o primeiro termo novamente, e testando se igual a 1; calculou então o terceiro termo, para isso calculando o segundo termo, para isso calculando o primeiro, e assim por diante. 
Além disso, no cálculo de cada termo, há um teste para ver se o termo anterior é ímpar ou par, o que por si só calcula o termo anterior.</p>
<p>Mais tarde veremos como tornar esta função muito mais eficiente, como na versão em C, em que o termo anterior só é calculado uma vez, mas por enquanto pensemos em como podemos limitar o número de passos nesta iteração.</p>
<div class="admonition exercise">
<p class="admonition-title">Exercício</p>
<ul>
<li>Modifique a definição da função converge para impedir que execute <em>ad eternum</em>.</li>
</ul>
<details class="hint"><summary>Dica</summary><ul>
<li>Use um contador para limitar o número de recursões e, no caso do limite ser alcançado, emita um erro.</li>
</ul>
</details>
<details class="example"><summary>Resolução</summary><ul>
<li>Use um contador para limitar o número de recursões e, no caso do limite ser alcançado, emita um erro.</li>
</ul>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nf">collatz</span> <span class="ow">::</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Int</span>
<span class="nf">collatz</span> <span class="n">n</span> <span class="n">i</span>
    <span class="o">|</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">=</span> <span class="n">n</span>
    <span class="o">|</span> <span class="n">even</span> <span class="p">(</span><span class="n">collatz</span> <span class="n">n</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="ow">=</span> <span class="n">collatz</span> <span class="n">n</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">`</span><span class="n">div</span><span class="p">`</span> <span class="mi">2</span>
    <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">collatz</span> <span class="n">n</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nf">converge</span> <span class="ow">::</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="kt">Bool</span>
<span class="nf">converge</span> <span class="n">n</span> <span class="n">passo</span> <span class="n">limite</span>
    <span class="o">|</span> <span class="n">limite</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">=</span> <span class="ne">error</span> <span class="s">&quot;Não alcançou uma resposta&quot;</span>
    <span class="o">|</span> <span class="n">collatz</span> <span class="n">n</span> <span class="n">passo</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">=</span> <span class="kt">True</span>
    <span class="o">|</span> <span class="n">otherwise</span> <span class="ow">=</span> <span class="n">converge</span> <span class="n">n</span> <span class="p">(</span><span class="n">passo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">limite</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
</details>
</div>
<h6>Binomial</h6>
<p>Há várias maneiras de se calcular o número de combinações que se pode obter com <span class="arithmatex">\(k\)</span> elementos de um conjunto de <span class="arithmatex">\(n\)</span> elementos.
Uma destas formas é via a seguinte recorrência.</p>
<div class="arithmatex">\[
\binom{n}{k} = 
     \begin{cases}
     \text{indefinido}   &amp; \text{se} k &gt; n\\
     1                   &amp; \text{se } k = 0\\
     1                   &amp; \text{se } k = n\\
     \binom{n-1}{k} + \binom{n-1}{k-1} &amp; \text{caso contrário }
     \end{cases}
\]</div>
<div class="admonition exercise">
<p class="admonition-title">Binomial</p>
<p>Implemente uma função recursiva que calcule <span class="arithmatex">\(\binom{n}{k}\)</span></p>
<details class="example"><summary>Resolução</summary><p>A ser implementado</p>
</details>
</div>
<h2 id="recursao-e-listas">Recursão e Listas</h2>
<p>Funções recursivas são particularmente importantes na manipulação listas, como veremos adiante.</p>
<h2 id="recursao-de-cauda">Recursão de Cauda</h2>
<p>A recursão de cauda é uma técnica importantíssima para melhorar o desempenho de funções recursivas ao economizar os recursos do sistema, e ao permitir as recursões possam até ser infinitas, como em laços infinitos usados em jogos, por exemplo.
Esta técnica será explorada no futuro, uma vez que já estejam confortáveis com recursões não otimizadas.</p>

  <!-- Last update of source file -->


              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../pattern_matching/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              Padrões
            </div>
          </div>
        </a>
      
      
        <a href="../where_let_in/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Próximo
              </span>
              Where e Let-In
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copiar para \u00e1rea de transfer\u00eancia", "clipboard.copied": "Copiado para \u00e1rea de transfer\u00eancia", "search.config.lang": "pt", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Buscar", "search.result.placeholder": "Digite para iniciar a busca", "search.result.none": "Nenhum resultado encontrado", "search.result.one": "1 resultado encontrado", "search.result.other": "# resultados encontrados", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4ea5477f.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@8.5.1/dist/mermaid.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../javascripts/mathjaxhelper.js"></script>
      
    
  </body>
</html>